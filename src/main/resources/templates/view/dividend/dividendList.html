<!--resources/templates/thymeleafEx.html-->
<!DOCTYPE html>
<html lang="ko" xmlns:th="http//www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>배당 거래내역</title>
  <!--부트스트랩-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>

  <!-- 부트 스트랩 -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


  <script type="text/javascript" th:src="@{/JS/dividend/dividend.js}"></script>
  <style>
    table{
      display:flex;
      /*display: -webkit-box;*/
      /*display: -ms-flexbox;*/
      overflow-x: auto;
      overflow-y: hidden;
      }
    tbody {
      display:flex;
      }
    th,td{
      height: 30px;
      width: 250px;
      display:block;
      }
  </style>

  <script th:inline="javascript">

  window.onload = function(){
    const data = /*[[${dList}]]*/;
    const trnscdate = /*[[${trnscdate}]]*/;
    const stockName = /*[[${stockName}]]*/;
    dividendList(data);
    trnscdateSelect(trnscdate);

    // 수정 모달찰 호출
    var exampleModal = document.getElementById('updateModal2')
    exampleModal.addEventListener('show.bs.modal', function (event) {
      fetchCall(event, exampleModal);
    })
  }
  </script>
</head>
<body>
  
    <label th:text="${title}"></label> 
    
    <br><br><br>
  <div>
      <a href="/">홈</a>
      <a href="/dividend/dividendList">배당화면</a>
      <a href="/clndr/dvdndClndr">일정관리</a>
      <br><br><br>
  </div>

<br>
  
  <div class="input-group">
    <form th:action="@{/dividend/dividendList}" method="get">
      <div class="input-group">
          &nbsp;&nbsp;
          <span class="input-group-text">년월</span>
          &nbsp;&nbsp;
        <div class="w-20">
          <select class="form-select" aria-label="Default select example" name="trnscdate" title="전체"  id="trnscdateSelect">
            <option value = "total">전체</option>
          </select>
        </div>
        &nbsp;&nbsp;
        <span class="input-group-text">항목</span>
          &nbsp;&nbsp;
          <input type="text" name="stockName" th:value="${stockName}"> 
          &nbsp;&nbsp;<button type="submit">검색</button>
      </div>
    </form>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
      등록
    </button>
  </div>

  
  <br>
  <table class="table table-bordered table-hover table-bordered">
    <thead >
      <tr >        
      <!--년도--><th >년도</th>
      <!--항목--><th>항목</th>
      <!--1월--> <th>01월</th>
      <!--2월--> <th>02월</th>
      <!--3월--> <th>03월</th>
      <!--4월--> <th>04월</th>
      <!--5월--> <th>05월</th>
      <!--6월--> <th>06월</th>
      <!--7월--> <th>07월</th>
      <!--8월--> <th>08월</th>
      <!--9월--> <th>09월</th>
      <!--10월--><th>10월</th>
      <!--11월--><th>11월</th>
      <!--12월--><th>12월</th>
      <!--12월--><th>합계</th>
      </tr>
    </thead>
    <tbody>
      <tr  th:each="dlist : ${dList}">    
            <!--년도--><td scope="col"><label th:text="${dlist.TRNSCDATE}"></label></td>
            <!--항목--><td th:text="${dlist.STOCK_NAME}"></td>
            <!--1월--> <td class="JANUARY" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.JANUARY}"></td>
            <!--2월--> <td class="FEBRUARY" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.FEBRUARY}"></td>
            <!--3월--> <td class="MARCH" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.MARCH}"></td>
            <!--4월--> <td class="APRIL" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.APRIL}"></td>
            <!--5월--> <td class="MAY" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.MAY}"></td>
            <!--6월--> <td class="JUNE" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.JUNE}" ></td>
            <!--7월--> <td class="JULY" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.JULY}" ></td>
            <!--8월--> <td class="AUGUST" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}" th:text="${dlist.AUGUST}" ></td>
            <!--9월--> <td class="SEPTEMBER" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}"  th:text="${dlist.SEPTEMBER}" ></td>
            <!--10월--><td class="OCTOBER" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}"  th:text="${dlist.OCTOBER}" ></td>
            <!--11월--><td class="NOVEMBER" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}"  th:text="${dlist.NOVEMBER}" ></td>
            <!--12월--><td class="DECEMBER" style="cursor:pointer;" data-bs-toggle="modal" data-bs-target="#updateModal2" th:attr="data-bs-whatever=${dlist}"  th:text="${dlist.DECEMBER}" ></td>
            <!--합계--><td th:text="${
              dlist.JANUARY 
              + dlist.FEBRUARY
              + dlist.MARCH
              + dlist.APRIL
              + dlist.MAY
              + dlist.JUNE
              + dlist.JULY
              + dlist.AUGUST
              + dlist.SEPTEMBER
              + dlist.OCTOBER
              + dlist.NOVEMBER
              + dlist.DECEMBER
            }" ></td>
      </tr>
    </tbody>
  </table>

  <br>
  <div >

    <canvas id="bar_chart"></canvas>

  </div>


 <!-- 등록 Modal -->
 <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">배당 등록</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
          <div class="mb-3 row">
              <label class="col-sm-3 col-form-label ">주식명</label>
              <div class="col-sm-8">
                <select class="form-select" aria-label="Default select example" id="selectBox">
                  <th:block th:each="selectBox : ${selectBox}">
	                  <option name="stockName" th:value="${selectBox.stockName}"
                    th:text="${selectBox.stockName}"></option>
                  </th:block>
                </select>
              </div>
            </div>
            <div class="mb-3 row">
              <label  class="col-sm-3 col-form-label">거래 일자</label>
              <div class="col-sm-8">
                <input type="date" class="form-control" id="inputTrnscdate">
              </div>
            </div>
            <div class="mb-3 row">
              <label  class="col-sm-3 col-form-label">거래 금액</label>
              <div class="col-sm-8">
                <input type="text" class="form-control inputAmount" id="inputAmount">
              </div>
            </div>
            
            <div class="mb-3 row">
              <div class="col-sm-11">
                <input type="file" class="form-control" id="inputFile" name="inputFile"  multiple="multiple" ><!--onchange="toBase64(event);"-->
              </div>
            </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">취소</button>
        <button type="button" class="btn btn-outline-success" onclick="transactionInsert();">저장</button>
      </div>
    </div>
  </div>
  </div>


  <!-- 수정 모달 창-->

  <div class="modal fade" id="updateModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">배당 수정</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="mb-3 row modal-body-stockName">
                <label class="col-sm-3 col-form-label ">주식명</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="inputstockName">
                </div>
            </div>
              <div class="mb-3 row">
                <label  class="col-sm-3 col-form-label">거래 일자</label>
                <div class="col-sm-8">
                  <input type="date" class="form-control" id="updateTrnscdate">
                </div>
              </div>
              <div class="mb-3 row modal-body-Amount">
                <label  class="col-sm-3 col-form-label">거래 금액</label>
                <div class="col-sm-8">
                  <input type="text" class="form-control" id="inputAmount">
                </div>
              </div>
              
              <div class="mb-3 row">
                <div class="col-sm-11">
                  <input type="file" class="form-control" id="updateFile" name="updateFile"  multiple="multiple" ><!--onchange="toBase64(event);"-->
                </div>
              </div>
              
              <div class="mb-3 row">
                <div class="col-sm-11">
                  <img id="image1" src="" alt="이미지">
                </div>
              </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal">취소</button>
          <button type="button" class="btn btn-outline-success" onclick="transactionInsert();">저장</button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
